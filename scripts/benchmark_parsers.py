"""
è§£æå™¨æ€§èƒ½å¯¹æ¯”æµ‹è¯•

å¯¹æ¯”ä¸‰ç§è§£ææ–¹æ¡ˆï¼š
1. Doclingï¼ˆæœ¬åœ°è½»é‡çº§ï¼‰
2. MinerU Pipelineï¼ˆæœ¬åœ°å¼ºå¤§å¤šæ¨¡æ€ï¼‰
3. MinerU Remote APIï¼ˆè¿œç¨‹è°ƒç”¨ï¼‰
"""

import asyncio
import time
import sys
import os
from pathlib import Path

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•
sys.path.insert(0, str(Path(__file__).parent.parent))

print("\n" + "="*80)
print("âš¡ è§£æå™¨æ€§èƒ½å¯¹æ¯”æµ‹è¯•")
print("="*80)

# é…ç½®ä¿¡æ¯
print("\nğŸ“‹ æµ‹è¯•é…ç½®ï¼š")
print("  - MinerU æ¨¡å‹ç‰ˆæœ¬: pipeline vs vlm")
print("  - å®˜æ–¹æ–‡æ¡£: https://mineru.net/apiManage/docs")
print()

# æ¨¡å‹ç‰ˆæœ¬è¯´æ˜
print("="*80)
print("ğŸ“š MinerU æ¨¡å‹ç‰ˆæœ¬è¯´æ˜")
print("="*80)

pipeline_info = """
ğŸ”§ Pipeline æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
  æ¶æ„: ä¼ ç»Ÿç®¡é“æ¶æ„ï¼ˆå¤šæ¨¡å‹ç»„åˆï¼‰
  ç»„æˆ:
    - PP-OCRv5: å¤šè¯­è¨€æ–‡å­—è¯†åˆ«ï¼ˆ37 ç§è¯­è¨€ï¼‰
    - DocLayout YOLO: å¸ƒå±€åˆ†æ
    - StructTable: è¡¨æ ¼è¯†åˆ«
    - UnimerNet: å…¬å¼è¯†åˆ«
  
  ä¼˜åŠ¿:
    âœ… æˆç†Ÿç¨³å®šï¼Œé’ˆå¯¹æ€§ä¼˜åŒ–
    âœ… é€Ÿåº¦è¾ƒå¿«ï¼ˆ~20% æå‡ in v2.1ï¼‰
    âœ… æ”¯æŒå‚ç›´æ–‡æœ¬
    âœ… èµ„æºå ç”¨ä¸­ç­‰
  
  é€‚ç”¨åœºæ™¯:
    - é»˜è®¤é€‰æ‹©
    - é€šç”¨æ–‡æ¡£è§£æ
    - æ‰¹é‡å¤„ç†
    - ç”Ÿäº§ç¯å¢ƒ
"""

vlm_info = """
ğŸ¤– VLM æ¨¡å¼ï¼ˆé«˜çº§ï¼‰
  æ¶æ„: ç»Ÿä¸€çš„è§†è§‰-è¯­è¨€å¤§æ¨¡å‹
  æ¨¡å‹: <1B å‚æ•°ï¼ˆæ¯” 72B VLM æ›´å‡†ç¡®ï¼ï¼‰
  
  ä¼˜åŠ¿:
    âœ… å‡†ç¡®åº¦æ›´é«˜ï¼ˆè¶…è¶Š 72B VLMï¼‰
    âœ… å•æ¨¡å‹æ¨ç†ï¼Œé€Ÿåº¦æ›´å¿«
    âœ… å³°å€¼åå: 10,000+ tokens/sï¼ˆ4090 + SGLangï¼‰
    âœ… æœ€ä½æ˜¾å­˜: 8GBï¼ˆTuring åŠä»¥ä¸Šï¼‰
    âœ… æ‰‹å†™è¯†åˆ«ä¼˜ç§€
  
  åŠ é€Ÿé€‰é¡¹:
    - SGLang åŠ é€Ÿï¼ˆå¿…éœ€ï¼‰
    - Torch Compileï¼ˆ+15% é€Ÿåº¦ï¼‰
    - æ•°æ®å¹¶è¡Œï¼ˆå¤šå¡ï¼‰
  
  é€‚ç”¨åœºæ™¯:
    - é«˜å‡†ç¡®åº¦è¦æ±‚
    - æ‰‹å†™æ–‡æ¡£
    - å¤æ‚è¡¨æ ¼
    - æœ‰ GPU èµ„æº
"""

print(pipeline_info)
print("-" * 80)
print(vlm_info)
print("="*80)

# æ€§èƒ½å¯¹æ¯”è¡¨
print("\nğŸ“Š ç†è®ºæ€§èƒ½å¯¹æ¯”")
print("="*80)

comparison_table = """
| æ–¹æ¡ˆ                  | å‡†ç¡®åº¦ | é€Ÿåº¦  | å†…å­˜å ç”¨ | GPU éœ€æ±‚ | é€‚ç”¨åœºæ™¯           |
|-----------------------|--------|-------|----------|----------|--------------------|
| Docling (æœ¬åœ°)        | â­â­â­  | âš¡âš¡âš¡âš¡âš¡ | æä½     | æ—        | çº¯æ–‡æœ¬ã€å°æ–‡ä»¶     |
| MinerU Pipeline (æœ¬åœ°)| â­â­â­â­ | âš¡âš¡âš¡âš¡  | ä¸­ç­‰     | å¯é€‰     | é€šç”¨æ–‡æ¡£ï¼ˆé»˜è®¤ï¼‰   |
| MinerU VLM (æœ¬åœ°)     | â­â­â­â­â­| âš¡âš¡âš¡âš¡âš¡ | ä½       | éœ€è¦ 8GB+| é«˜è¦æ±‚ã€æ‰‹å†™æ–‡æ¡£   |
| MinerU Remote API     | â­â­â­â­ | âš¡âš¡â­   | æä½     | æ—        | èµ„æºå—é™ã€æµ‹è¯•ç¯å¢ƒ |
"""

print(comparison_table)

# å®é™…æµ‹è¯•å»ºè®®
print("\n" + "="*80)
print("ğŸ§ª å®é™…æµ‹è¯•æ–¹æ¡ˆ")
print("="*80)

print("""
æµ‹è¯•æ–‡ä»¶å»ºè®®ï¼š
  1. çº¯æ–‡æœ¬ (.txt, 100KB)     â†’ æµ‹è¯• LightRAG ç›´æ¥æ’å…¥
  2. ç®€å• PDF (.pdf, 500KB)   â†’ æµ‹è¯• Docling æ€§èƒ½
  3. å¤æ‚ PDF (.pdf, 2MB)     â†’ æµ‹è¯• MinerU Pipeline
  4. æ‰‹å†™æ–‡æ¡£ (.pdf, 1MB)     â†’ æµ‹è¯• MinerU VLMï¼ˆå¦‚æœæœ‰ GPUï¼‰
  5. Office æ–‡æ¡£ (.docx, 1MB) â†’ æµ‹è¯• MinerU Pipeline vs Docling

æµ‹è¯•ç»´åº¦ï¼š
  âœ“ è§£ææ—¶é—´ï¼ˆç§’ï¼‰
  âœ“ å†…å­˜å ç”¨ï¼ˆå³°å€¼ MBï¼‰
  âœ“ CPU ä½¿ç”¨ç‡ï¼ˆ%ï¼‰
  âœ“ å‡†ç¡®åº¦ï¼ˆäººå·¥è¯„ä¼°ï¼‰
  âœ“ æå–å†…å®¹å®Œæ•´æ€§
""")

# API é…ç½®è¯´æ˜
print("="*80)
print("ğŸ”§ MinerU API æ¨¡å‹ç‰ˆæœ¬é…ç½®")
print("="*80)

print("""
åœ¨ API è¯·æ±‚ä¸­æŒ‡å®šæ¨¡å‹ç‰ˆæœ¬ï¼š

æ–¹å¼ 1: é€šè¿‡ç¯å¢ƒå˜é‡ï¼ˆå…¨å±€é»˜è®¤ï¼‰
  env.example ä¸­æ·»åŠ :
    MINERU_MODEL_VERSION=pipeline  # æˆ– vlm

æ–¹å¼ 2: åœ¨è¯·æ±‚ä¸­æŒ‡å®šï¼ˆä¼˜å…ˆçº§æ›´é«˜ï¼‰
  ParseOptions(
      model_version="vlm",  # æˆ– "pipeline"
      enable_formula=True,
      enable_table=True
  )

ç¤ºä¾‹ï¼ˆå®˜æ–¹æ–‡æ¡£ï¼‰ï¼š
  {
    "model_version": "vlm",           # æŒ‡å®šä½¿ç”¨ VLM æ¨¡å¼
    "enable_formula": true,
    "enable_table": true,
    "files": [...]
  }

æ€§èƒ½ä¼˜åŒ–å»ºè®®ï¼š
  - Pipelineï¼ˆé»˜è®¤ï¼‰: é€šç”¨åœºæ™¯ï¼Œå¹³è¡¡æ€§èƒ½å’Œèµ„æº
  - VLM: è¿½æ±‚æœ€é«˜å‡†ç¡®åº¦ï¼Œæœ‰ GPU èµ„æº
  - Remote API: æœ¬åœ°èµ„æºå—é™ï¼Œå¯æ¥å—ç½‘ç»œå»¶è¿Ÿ
""")

# å½“å‰ç³»ç»ŸçŠ¶æ€
print("="*80)
print("ğŸ’¡ å½“å‰ç³»ç»Ÿé…ç½®")
print("="*80)

mineru_mode = os.getenv("MINERU_MODE", "local")
print(f"""
âœ“ å·²å®ç°è§£æå™¨ï¼š
  1. LightRAG ç›´æ¥æ’å…¥ - çº¯æ–‡æœ¬æ–‡ä»¶ï¼ˆ.txt, .mdï¼‰
  2. Docling - PDF/Office å°æ–‡ä»¶ï¼ˆ< 500KBï¼‰
  3. MinerU Pipelineï¼ˆæœ¬åœ°ï¼‰- å¤§æ–‡ä»¶ã€å¤æ‚æ–‡æ¡£
  
âœ“ MinerU æ¨¡å¼: {mineru_mode}

âœ“ æ™ºèƒ½é€‰æ‹©ç­–ç•¥:
  - çº¯æ–‡æœ¬ â†’ LightRAG ç›´æ¥æ’å…¥ï¼ˆæœ€å¿«ï¼‰
  - å°æ–‡ä»¶ â†’ Doclingï¼ˆå¿«é€Ÿï¼‰
  - å¤§æ–‡ä»¶/å¤æ‚ â†’ MinerU Pipelineï¼ˆå¼ºå¤§ï¼‰
  
â“ å¯é…ç½®çš„ MinerU é€‰é¡¹ï¼š
  - model_version: "pipeline"ï¼ˆé»˜è®¤ï¼‰/ "vlm"ï¼ˆé«˜çº§ï¼‰
  - enable_formula: å…¬å¼è¯†åˆ«
  - enable_table: è¡¨æ ¼è¯†åˆ«
  - language: è¯­è¨€è®¾ç½®
  - page_ranges: æŒ‡å®šé¡µç èŒƒå›´
""")

print("="*80)
print("ğŸ¯ å»ºè®®é…ç½®")
print("="*80)

print("""
åœºæ™¯ 1: æµ‹è¯•ç¯å¢ƒï¼ˆèµ„æºå—é™ï¼‰
  MINERU_MODE=remote
  MINERU_MODEL_VERSION=pipeline
  â†’ è¿œç¨‹è°ƒç”¨ï¼Œæ— éœ€æœ¬åœ° GPUï¼Œé€Ÿåº¦ä¸­ç­‰

åœºæ™¯ 2: ç”Ÿäº§ç¯å¢ƒï¼ˆæœ‰ GPUï¼Œ8GB+ æ˜¾å­˜ï¼‰
  MINERU_MODE=local
  MINERU_MODEL_VERSION=vlm
  â†’ æœ¬åœ° VLMï¼Œæœ€é«˜å‡†ç¡®åº¦ï¼Œæœ€å¿«é€Ÿåº¦

åœºæ™¯ 3: ç”Ÿäº§ç¯å¢ƒï¼ˆæ—  GPUï¼‰
  MINERU_MODE=local
  MINERU_MODEL_VERSION=pipeline
  â†’ æœ¬åœ° Pipelineï¼Œå¹³è¡¡æ€§èƒ½

åœºæ™¯ 4: æ··åˆæ¨¡å¼ï¼ˆæ¨èï¼‰
  - å°æ–‡ä»¶ â†’ Doclingï¼ˆæœ¬åœ°ï¼‰
  - å¤§æ–‡ä»¶ â†’ MinerU Remote API
  â†’ æˆæœ¬å’Œæ€§èƒ½æœ€ä¼˜
""")

print("="*80)
print("\nğŸ’¡ ä¸‹ä¸€æ­¥æ“ä½œå»ºè®®:")
print("  1. åœ¨ env.example ä¸­æ·»åŠ  MINERU_MODEL_VERSION é…ç½®")
print("  2. æ›´æ–° ParseOptions é»˜è®¤ä½¿ç”¨ç¯å¢ƒå˜é‡ä¸­çš„ model_version")
print("  3. åˆ›å»ºå®é™…æ–‡ä»¶çš„æ€§èƒ½æµ‹è¯•è„šæœ¬")
print("  4. åœ¨æœåŠ¡å™¨ä¸Šå¯¹æ¯” Docling vs MinerU Pipeline çš„å®é™…æ€§èƒ½")
print("\n" + "="*80 + "\n")

