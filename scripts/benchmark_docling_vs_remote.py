"""
Doclingï¼ˆæœ¬åœ°ï¼‰vs MinerU Remote APIï¼ˆè¿œç¨‹ï¼‰æ€§èƒ½å¯¹æ¯”

æµ‹è¯•ç­–ç•¥ï¼š
- Docling: æœ¬åœ°è½»é‡çº§è§£æå™¨ï¼Œé€‚åˆå°æ–‡ä»¶
- MinerU Remote: è¿œç¨‹ API è°ƒç”¨ï¼Œé€‚åˆå¤æ‚æ–‡æ¡£

æµ‹è¯•ç»´åº¦ï¼š
âœ“ è§£ææ—¶é—´
âœ“ API å“åº”æ—¶é—´
âœ“ å‡†ç¡®åº¦è¯„ä¼°
âœ“ èµ„æºå ç”¨
"""

import asyncio
import time
import sys
import os
from pathlib import Path

# æ·»åŠ é¡¹ç›®æ ¹ç›®å½•
sys.path.insert(0, str(Path(__file__).parent.parent))

print("\n" + "="*80)
print("âš¡ Docling vs MinerU Remote API æ€§èƒ½å¯¹æ¯”")
print("="*80)

# é…ç½®è¯´æ˜
print("""
ğŸ“Š å¯¹æ¯”æ–¹æ¡ˆï¼š

1ï¸âƒ£  Doclingï¼ˆæœ¬åœ°ï¼‰
   æ¶æ„: è½»é‡çº§ Python è§£æå™¨
   ä¼˜åŠ¿: âœ… å¿«é€Ÿã€âœ… ä½èµ„æºã€âœ… å…è´¹
   é™åˆ¶: âš ï¸ ä¸æ”¯æŒ .txtã€âš ï¸ å‡†ç¡®åº¦ä¸­ç­‰
   é€‚ç”¨: å°å‹ PDF/Office æ–‡æ¡£ï¼ˆ< 500KBï¼‰

2ï¸âƒ£  MinerU Remote APIï¼ˆè¿œç¨‹ï¼‰
   æ¶æ„: è°ƒç”¨ mineru.net å®˜æ–¹ API
   ä¼˜åŠ¿: âœ… é«˜å‡†ç¡®åº¦ã€âœ… é›¶æœ¬åœ°èµ„æºã€âœ… æ”¯æŒæ‰€æœ‰æ ¼å¼
   é™åˆ¶: âš ï¸ ç½‘ç»œå»¶è¿Ÿã€âš ï¸ æ¯æ—¥é¢åº¦é™åˆ¶ï¼ˆ2000 é¡µï¼‰
   é€‚ç”¨: å¤æ‚æ–‡æ¡£ã€å¤§æ–‡ä»¶ã€æ‰‹å†™æ–‡æ¡£

3ï¸âƒ£  LightRAG ç›´æ¥æ’å…¥ï¼ˆæœ¬åœ°ï¼‰
   æ¶æ„: è·³è¿‡è§£æï¼Œç›´æ¥æ’å…¥çŸ¥è¯†å›¾è°±
   ä¼˜åŠ¿: âœ… æå¿«ã€âœ… é›¶èµ„æº
   é€‚ç”¨: çº¯æ–‡æœ¬æ–‡ä»¶ï¼ˆ.txt, .mdï¼‰
""")

# æµ‹è¯•åœºæ™¯
print("="*80)
print("ğŸ§ª æµ‹è¯•åœºæ™¯")
print("="*80)

test_scenarios = {
    "1": {
        "name": "å°å‹ PDFï¼ˆ< 500KBï¼‰",
        "file_type": ".pdf",
        "size": "400KB",
        "expected_winner": "Docling",
        "reason": "æœ¬åœ°è§£æï¼Œæ— ç½‘ç»œå»¶è¿Ÿ"
    },
    "2": {
        "name": "å¤§å‹ PDFï¼ˆ> 2MBï¼‰",
        "file_type": ".pdf",
        "size": "2.5MB",
        "expected_winner": "MinerU Remote",
        "reason": "å¤æ‚æ–‡æ¡£ï¼Œé«˜å‡†ç¡®åº¦"
    },
    "3": {
        "name": "Office æ–‡æ¡£ï¼ˆDOCXï¼‰",
        "file_type": ".docx",
        "size": "1MB",
        "expected_winner": "å–å†³äºç½‘ç»œ",
        "reason": "ä¸¤è€…éƒ½æ”¯æŒï¼Œé€Ÿåº¦æ¥è¿‘"
    },
    "4": {
        "name": "çº¯æ–‡æœ¬ï¼ˆTXTï¼‰",
        "file_type": ".txt",
        "size": "100KB",
        "expected_winner": "LightRAG ç›´æ¥æ’å…¥",
        "reason": "è·³è¿‡è§£æï¼Œç›´æ¥æ’å…¥"
    },
    "5": {
        "name": "å›¾ç‰‡æ–‡æ¡£ï¼ˆJPGï¼‰",
        "file_type": ".jpg",
        "size": "500KB",
        "expected_winner": "MinerU Remote",
        "reason": "éœ€è¦ OCRï¼ŒDocling ä¸æ”¯æŒ"
    },
}

for key, scenario in test_scenarios.items():
    print(f"\nåœºæ™¯ {key}: {scenario['name']}")
    print(f"  æ–‡ä»¶ç±»å‹: {scenario['file_type']}")
    print(f"  æ–‡ä»¶å¤§å°: {scenario['size']}")
    print(f"  é¢„æœŸæœ€ä¼˜: {scenario['expected_winner']}")
    print(f"  åŸå› : {scenario['reason']}")

# MinerU æ¨¡å‹ç‰ˆæœ¬è¯´æ˜
print("\n" + "="*80)
print("ğŸ¤– MinerU æ¨¡å‹ç‰ˆæœ¬é€‰æ‹©")
print("="*80)

print("""
Pipeline æ¨¡å¼ï¼ˆé»˜è®¤ï¼Œæ¨èï¼‰:
  âœ“ æˆç†Ÿç¨³å®šçš„å¤šæ¨¡å‹ç»„åˆ
  âœ“ PP-OCRv5ï¼ˆ37 ç§è¯­è¨€ï¼‰
  âœ“ DocLayout YOLOï¼ˆå¸ƒå±€åˆ†æï¼‰
  âœ“ StructTableï¼ˆè¡¨æ ¼è¯†åˆ«ï¼‰
  âœ“ UnimerNetï¼ˆå…¬å¼è¯†åˆ«ï¼‰
  âœ“ é€Ÿåº¦å¿«ï¼Œèµ„æºå ç”¨ä¸­ç­‰
  â†’ æ¨èç”¨äºç”Ÿäº§ç¯å¢ƒ

VLM æ¨¡å¼ï¼ˆé«˜çº§ï¼‰:
  âœ“ ç»Ÿä¸€å¤šæ¨¡æ€æ¨¡å‹ï¼ˆ< 1B å‚æ•°ï¼‰
  âœ“ å‡†ç¡®åº¦è¶…è¶Š 72B VLM
  âœ“ å³°å€¼åå 10,000+ tokens/s
  âœ“ æ‰‹å†™è¯†åˆ«ä¼˜ç§€
  âœ“ éœ€è¦ SGLang åŠ é€Ÿ
  â†’ æ¨èç”¨äºé«˜è¦æ±‚åœºæ™¯

é…ç½®æ–¹æ³•:
  åœ¨ .env ä¸­è®¾ç½®:
    MINERU_MODEL_VERSION=pipeline  # æˆ– vlm
""")

# å®é™…æµ‹è¯•æµç¨‹
print("="*80)
print("ğŸ”¬ æ€§èƒ½æµ‹è¯•æµç¨‹")
print("="*80)

print("""
å‡†å¤‡å·¥ä½œï¼š
  1. åœ¨ .env ä¸­é…ç½® MINERU_API_TOKEN
  2. å‡†å¤‡æµ‹è¯•æ–‡ä»¶ï¼ˆå° PDFã€å¤§ PDFã€DOCXã€TXTã€JPGï¼‰
  3. ç¡®ä¿æœåŠ¡å·²å¯åŠ¨

æµ‹è¯•æ­¥éª¤ï¼š
  1. ä¸Šä¼ æµ‹è¯•æ–‡ä»¶åˆ° /insert æ¥å£
  2. è®°å½•ä»»åŠ¡åˆ›å»ºæ—¶é—´
  3. è½®è¯¢ä»»åŠ¡çŠ¶æ€ï¼Œè®°å½•å®Œæˆæ—¶é—´
  4. è®¡ç®—æ€»è€—æ—¶
  5. å¯¹æ¯”ä¸åŒè§£æå™¨çš„æ€§èƒ½

æ€§èƒ½æŒ‡æ ‡ï¼š
  âœ“ ç«¯åˆ°ç«¯æ—¶é—´ï¼ˆE2Eï¼‰
  âœ“ è§£ææ—¶é—´ï¼ˆParsing Timeï¼‰
  âœ“ å†…å®¹å®Œæ•´æ€§ï¼ˆäººå·¥è¯„ä¼°ï¼‰
  âœ“ èµ„æºå ç”¨ï¼ˆDocker statsï¼‰

è¿è¡Œå‘½ä»¤ï¼š
  # ä¸Šä¼ æµ‹è¯•æ–‡ä»¶
  curl -X POST 'http://localhost:8000/insert?doc_id=test_001' \\
    -F 'file=@test.pdf' \\
    -F 'parser=auto'  # auto / docling / mineru

  # æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
  curl 'http://localhost:8000/task/{task_id}'
""")

# æ¨èé…ç½®
print("="*80)
print("ğŸ¯ æ¨èé…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰")
print("="*80)

print("""
æ–¹æ¡ˆ Aï¼šæˆæœ¬ä¼˜å…ˆï¼ˆæ¨èï¼‰
  MINERU_MODE=remote
  MINERU_MODEL_VERSION=pipeline
  
  ä¼˜åŠ¿:
    âœ… é›¶æœ¬åœ°èµ„æºå ç”¨
    âœ… æ— éœ€ GPU
    âœ… æ— éœ€ä¸‹è½½æ¨¡å‹
    âœ… å…è´¹é¢åº¦ 2000 é¡µ/å¤©
  
  åŠ£åŠ¿:
    âš ï¸ ç½‘ç»œå»¶è¿Ÿï¼ˆ~3-10 ç§’ï¼‰
    âš ï¸ ä¾èµ–å¤–éƒ¨æœåŠ¡

æ–¹æ¡ˆ Bï¼šæ€§èƒ½ä¼˜å…ˆï¼ˆå¦‚æœæœ‰é«˜é…æœåŠ¡å™¨ï¼‰
  MINERU_MODE=local
  MINERU_MODEL_VERSION=vlm
  + GPUï¼ˆ8GB+ æ˜¾å­˜ï¼‰
  + SGLang åŠ é€Ÿ
  
  ä¼˜åŠ¿:
    âœ… æœ€é«˜å‡†ç¡®åº¦
    âœ… æœ€å¿«é€Ÿåº¦ï¼ˆ10,000+ tokens/sï¼‰
    âœ… æ— ç½‘ç»œä¾èµ–
  
  åŠ£åŠ¿:
    âš ï¸ éœ€è¦ GPU
    âš ï¸ å ç”¨æ˜¾å­˜ 8GB+
    âš ï¸ éœ€è¦ä¸‹è½½æ¨¡å‹

æ–¹æ¡ˆ Cï¼šæ··åˆæ¨¡å¼ï¼ˆæœ€ä½³å®è·µï¼‰
  - å°æ–‡ä»¶ï¼ˆ< 500KBï¼‰â†’ Doclingï¼ˆæœ¬åœ°ï¼‰
  - å¤§æ–‡ä»¶ï¼ˆ> 500KBï¼‰â†’ MinerU Remote API
  - çº¯æ–‡æœ¬ â†’ LightRAG ç›´æ¥æ’å…¥
  
  ä¼˜åŠ¿:
    âœ… æˆæœ¬æœ€ä½
    âœ… æ€§èƒ½æœ€ä¼˜
    âœ… çµæ´»å¯æ§
""")

print("="*80)
print("\nâœ… å¯¹æ¯”è¯´æ˜å®Œæˆï¼")
print("\nğŸ’¡ ä¸‹ä¸€æ­¥ï¼š")
print("  1. é…ç½® MINERU_API_TOKEN")
print("  2. åœ¨æœåŠ¡å™¨ä¸Šæµ‹è¯•å®é™…æ€§èƒ½")
print("  3. æ ¹æ®æµ‹è¯•ç»“æœè°ƒæ•´æ™ºèƒ½é€‰æ‹©ç­–ç•¥")
print("\n" + "="*80 + "\n")

